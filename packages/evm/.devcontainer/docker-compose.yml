# Docker Compose for zodiac-modifier-roles-evm devcontainer
# Provides a sandboxed environment for Solidity development with Claude Code

services:
  evm:
    build:
      context: .
      dockerfile: Dockerfile
    volumes:
      # Mount only the workspace - no home directory, SSH keys, or credentials
      - ..:/workspace:cached
      # Use separate volume for node_modules to avoid platform binary conflicts
      # (host macOS binaries don't work in Linux container)
      - node_modules:/workspace/node_modules
      # Persist Claude CLI auth between container restarts
      - claude-config:/home/node
    # Run setup on first start, then keep container alive
    entrypoint: /workspace/.devcontainer/entrypoint.sh
    command: ["sleep", "infinity"]
    environment:
      # Node environment
      NODE_ENV: development

volumes:
  node_modules:
    name: zodiac-roles-evm-node-modules
  claude-config:
    name: zodiac-roles-evm-claude-config
